#!/bin/bash

. $(dirname $0)/__/common

cd $ROOT

APP=$1
ARGS=${@:1}

trap killgroup SIGINT
killgroup() {
  kill 0
}

if [ "$APP" = "electron" ]; then
  cd $ROOT/apps/electron
  npm run dist
elif [ "$APP" = "web" ]; then
  cd $ROOT/apps/web
  npm run build
else
  # flow
  link-flow &
  # lerna
  npx lerna exec --parallel \
    --ignore @mcro/native  \
    --ignore @mcro/web \
    --ignore @mcro/couch \
    --ignore @mcro/playground \
      -- \
      babel src --out-dir lib -s true $ARGS &

  wait
  echo "done"
fi
