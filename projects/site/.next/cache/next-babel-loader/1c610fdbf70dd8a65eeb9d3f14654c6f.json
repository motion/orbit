{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/extends\";\n\n(function () {\n  var enterModule = (typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal : require('react-hot-loader')).enterModule;\n  enterModule && enterModule(module);\n})();\n\nvar __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {\n  return a;\n};\n\nimport memoize from 'memoize-weak';\nimport { useCurrentRoute } from 'react-navi';\nimport { routeTable } from './routeTable';\nimport { HeaderContext } from './views/HeaderContext';\n\nvar getNavigation = () => window['Navigation'];\n\nvar isOnRoute = (path, route) => route.url.pathname === path;\n\nexport var useIsActiveRoute = href => {\n  var route = useCurrentRoute();\n  return isOnRoute(href, route);\n};\n\n__signature__(useIsActiveRoute, \"useCurrentRoute{route}\", () => [useCurrentRoute]);\n\nvar nullLink = e => e.preventDefault();\n\nvar loadedRoutes = {};\nvar createPreloadLink = memoize(href => () => {\n  // pre load pages on hover\n  if (loadedRoutes[href]) {\n    return;\n  }\n\n  if (routeTable[href]) {\n    routeTable[href]().then(x => {\n      var theme = Object.keys(x).reduce((a, k) => a || x[k].theme, null);\n      loadedRoutes[href] = theme;\n    });\n  }\n});\nexport var useLink = href => {\n  var header = HeaderContext.useStore();\n  var isActive = useIsActiveRoute(href);\n  return _extends({}, linkProps(href, {\n    header,\n    isActive\n  }), {\n    isActive\n  });\n};\n\n__signature__(useLink, \"useStore{header}\\nuseIsActiveRoute{isActive}\", () => [HeaderContext.useStore, useIsActiveRoute]);\n\nvar tm = null;\nexport var createLink = memoize(function (href, header, isExternal) {\n  if (header === void 0) {\n    header = null;\n  }\n\n  if (isExternal === void 0) {\n    isExternal = false;\n  }\n\n  return async e => {\n    if (isExternal || checkExternal(href)) {\n      return;\n    }\n\n    clearTimeout(tm);\n    e.preventDefault(); // transition out body on slow\n\n    var tm2 = setTimeout(() => {\n      document.body.classList.add('will-load');\n      document.body.classList.add('loading');\n    }, 200);\n\n    var finish = () => {\n      getNavigation().navigate(href).then(() => {\n        clearTimeout(tm2);\n        document.body.classList.remove('loading');\n        document.body.classList.remove('will-load');\n      });\n    };\n\n    if (header) {\n      header.setShown(false);\n      tm = setTimeout(finish, 90);\n    } else {\n      finish();\n    }\n  };\n});\nexport var linkProps = function linkProps(href, opts) {\n  if (opts === void 0) {\n    opts = {};\n  }\n\n  return _extends({\n    href,\n    tagName: 'a'\n  }, !!opts.header && {\n    className: 'will-transform'\n  }, {\n    textDecoration: 'none',\n    cursor: 'pointer',\n    target: opts.isExternal || checkExternal(href) ? '_blank' : undefined,\n    onClick: opts.isActive ? nullLink : createLink(href, opts.header, opts.isExternal),\n    onMouseEnter: createPreloadLink(href)\n  });\n};\n\nvar checkExternal = href => href.indexOf('http') === 0 || href.indexOf('mailto') === 0;\n\n;\n\n(function () {\n  var reactHotLoader = (typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal : require('react-hot-loader')).default;\n\n  if (!reactHotLoader) {\n    return;\n  }\n\n  reactHotLoader.register(getNavigation, \"getNavigation\", \"/Users/nw/projects/motion/orbit/projects/site/useLink.tsx\");\n  reactHotLoader.register(isOnRoute, \"isOnRoute\", \"/Users/nw/projects/motion/orbit/projects/site/useLink.tsx\");\n  reactHotLoader.register(useIsActiveRoute, \"useIsActiveRoute\", \"/Users/nw/projects/motion/orbit/projects/site/useLink.tsx\");\n  reactHotLoader.register(nullLink, \"nullLink\", \"/Users/nw/projects/motion/orbit/projects/site/useLink.tsx\");\n  reactHotLoader.register(loadedRoutes, \"loadedRoutes\", \"/Users/nw/projects/motion/orbit/projects/site/useLink.tsx\");\n  reactHotLoader.register(createPreloadLink, \"createPreloadLink\", \"/Users/nw/projects/motion/orbit/projects/site/useLink.tsx\");\n  reactHotLoader.register(useLink, \"useLink\", \"/Users/nw/projects/motion/orbit/projects/site/useLink.tsx\");\n  reactHotLoader.register(tm, \"tm\", \"/Users/nw/projects/motion/orbit/projects/site/useLink.tsx\");\n  reactHotLoader.register(createLink, \"createLink\", \"/Users/nw/projects/motion/orbit/projects/site/useLink.tsx\");\n  reactHotLoader.register(linkProps, \"linkProps\", \"/Users/nw/projects/motion/orbit/projects/site/useLink.tsx\");\n  reactHotLoader.register(checkExternal, \"checkExternal\", \"/Users/nw/projects/motion/orbit/projects/site/useLink.tsx\");\n})();\n\n;\n\n(function () {\n  var leaveModule = (typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal : require('react-hot-loader')).leaveModule;\n  leaveModule && leaveModule(module);\n})();","map":{"version":3,"sources":["/Users/nw/projects/motion/orbit/projects/site/useLink.tsx"],"names":["memoize","useCurrentRoute","routeTable","HeaderContext","getNavigation","window","isOnRoute","path","route","url","pathname","useIsActiveRoute","href","nullLink","e","preventDefault","loadedRoutes","createPreloadLink","then","x","theme","Object","keys","reduce","a","k","useLink","header","useStore","isActive","linkProps","tm","createLink","isExternal","checkExternal","clearTimeout","tm2","setTimeout","document","body","classList","add","finish","navigate","remove","setShown","opts","tagName","className","textDecoration","cursor","target","undefined","onClick","onMouseEnter","indexOf"],"mappings":"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","sourcesContent":["import memoize from 'memoize-weak'\nimport { useCurrentRoute } from 'react-navi'\n\nimport { routeTable } from './routeTable'\nimport { HeaderContext } from './views/HeaderContext'\n\nconst getNavigation = () => window['Navigation']\n\nconst isOnRoute = (path, route) => route.url.pathname === path\n\nexport const useIsActiveRoute = (href: string) => {\n  const route = useCurrentRoute()\n  return isOnRoute(href, route)\n}\nconst nullLink = e => e.preventDefault()\nconst loadedRoutes = {}\n\nconst createPreloadLink = memoize(href => () => {\n  // pre load pages on hover\n  if (loadedRoutes[href]) {\n    return\n  }\n  if (routeTable[href]) {\n    routeTable[href]().then(x => {\n      const theme = Object.keys(x).reduce((a, k) => a || x[k].theme, null)\n      loadedRoutes[href] = theme\n    })\n  }\n})\n\nexport const useLink = (href: string) => {\n  const header = HeaderContext.useStore()\n  const isActive = useIsActiveRoute(href)\n  return {\n    ...linkProps(href, { header, isActive }),\n    isActive,\n  }\n}\n\nlet tm = null\n\nexport const createLink = memoize((href: string, header = null, isExternal = false) => async e => {\n  if (isExternal || checkExternal(href)) {\n    return\n  }\n  clearTimeout(tm)\n  e.preventDefault()\n  // transition out body on slow\n  let tm2 = setTimeout(() => {\n    document.body.classList.add('will-load')\n    document.body.classList.add('loading')\n  }, 200)\n  const finish = () => {\n    getNavigation()\n      .navigate(href)\n      .then(() => {\n        clearTimeout(tm2)\n        document.body.classList.remove('loading')\n        document.body.classList.remove('will-load')\n      })\n  }\n  if (header) {\n    header.setShown(false)\n    tm = setTimeout(finish, 90)\n  } else {\n    finish()\n  }\n})\n\nexport const linkProps = (\n  href: string,\n  opts: {\n    header?: any\n    isActive?: boolean\n    isExternal?: boolean\n  } = {},\n): any => {\n  return {\n    href,\n    tagName: 'a',\n    ...(!!opts.header && { className: 'will-transform' }),\n    textDecoration: 'none',\n    cursor: 'pointer',\n    target: opts.isExternal || checkExternal(href) ? '_blank' : undefined,\n    onClick: opts.isActive ? nullLink : createLink(href, opts.header, opts.isExternal),\n    onMouseEnter: createPreloadLink(href),\n  }\n}\nconst checkExternal = href => href.indexOf('http') === 0 || href.indexOf('mailto') === 0\n"]},"metadata":{},"sourceType":"module"}