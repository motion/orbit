#!/bin/bash

. $(dirname $0)/__common
cd $ROOT

# set dev context
export KUBECONFIG=infra/keys/kubes/dev
kubectl config use-context minikube

export DEV=true

ACTION=$1

if minikube docker-env > /dev/null 2>&1; then
  eval $(minikube docker-env)
else
  echo "minikube is not running..."
  minikube start
  sleep 3
fi

bin/__kubes ${@:1}

# extra post actions
if [ "$ACTION" = "stop" ]; then
  minikube stop
fi
