#!/bin/bash

. $(dirname $0)/__/common

# if in root
if [ "$(realpath .)" = "$ROOT" ]; then
  echo "building.... $(pwd)"
  # build
  if [ "$1" = "" ]; then
    (bin/in orbit tsc --build --force) &
    (bin/in orbit-desktop tsc) &
    (bin/in ui npm run build) &
    (bin/in store-hmr npm run build) &
    wait
  fi
  # build --watch
  if [ "$1" = "--watch" ]; then
    (bin/in orbit tsc --build --watch) &
    (bin/in ui npm run watch) &
    (bin/in store-hmr npm run build --watch) &
    wait
  fi
  exit 0
fi

