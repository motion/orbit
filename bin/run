#!/bin/bash

. $(dirname $0)/__/common
cd $ROOT

ACTION=$1
ARG1=$2

if [ "$ACTION" = "backend" ]; then
  compose up ${@:2}
elif [ "$ACTION" = "electron" ]; then
  cd apps/electron
  npm run watch &
  sleep 1
  npm start
  fg
elif [ "$ACTION" =  "web" ]; then
  if [ ! -d "$ROOT/packages/ui/lib" ]; then
    echo "Make sure to run 'build --watch' before running web"
    exit 0
  fi

  cd apps/web
  if [ "$ARG1" = "--clean" ]; then
    motion watch --disable-cache
  else
    motion watch ${@:2}
  fi
else
  npm run $1 ${@:2}
fi
