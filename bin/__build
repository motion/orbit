#!/bin/bash

. $(dirname $0)/__common
cd $ROOT

echo "namespace $NAMESPACE"

APP=$1

# sets build_arg ENV=production
# so you can do different stuff

buildapi() {
  docker build \
    --build-arg ENV=prod
    -t motion/starter-api \
    -f infra/images/api.dockerfile \
    .

  docker push motion/starter-api
}

buildpublic() {
  docker build \
    --build-arg ENV=prod
    -t motion/starter-public \
    -f infra/images/public.dockerfile \
    .

  docker push motion/starter-public
}

if [ "$APP" = "all" ]; then
  buildapi
  buildpublic
elif [ "$APP" = "public" ]; then
  buildpublic
elif [ "$APP" = "api" ]; then
  buildapi
fi
